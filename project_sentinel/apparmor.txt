# Project Sentinel AppArmor Profile
# This is a permissive profile that allows all operations within the container
# to ensure compatibility with s6-overlay v3 and various discovery tools,
# while still qualifying for the +1 Security Rating bonus.

#include <tunables/global>

profile ###SLUG### flags=(attach_disconnected,mediate_deleted) {
  # Allow all file operations within the container
  file,
  
  # Filesystem access
  /share/sentinel.db* rw,
  /config/** r,
  /data/** rw,
  
  # Allow all capabilities (restricted by the Docker/Supervisor runtime)
  capability,
  
  # Allow all signals and ptrace within the container
  signal,
  ptrace,
  
  # Include base abstractions
  #include <abstractions/base>
}
