# Project Sentinel AppArmor Rules
# Rules only, no profile header needed for Home Assistant Add-ons.

#include <abstractions/base>
#include <abstractions/python>
#include <abstractions/nameservice>

# Allow common system execution paths
/bin/** rmix,
/sbin/** rmix,
/usr/bin/** rmix,
/usr/sbin/** rmix,
/lib/** rmix,
/usr/lib/** rmix,

# Allow the s6-overlay /init system
/init rmix,

# Network access
network,
capability net_admin,
capability net_raw,

# Filesystem access for database and options
/share/sentinel.db* rw,
/data/** rw,
/tmp/** rw,
/run/** rw,
/proc/** r,
/sys/** r,

# Python specific
/usr/local/lib/python*/** r,
/usr/local/bin/python* rmix,

# Deny critical host files
deny /etc/passwd r,
deny /etc/shadow r,
